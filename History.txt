===============================================================================
  更新履歴
===============================================================================
2017/03/15
LilithPort v1.08
新機能追加と操作性の向上を図ったレイアウトの変更、不具合修正による安定性の向上

■新機能
・UPnPポート開閉機能(UDP)を追加しました。
  スタートアップフォームからお手軽にポートを開放することができます。
  ポート開放に成功すると、ServerモードやHostモードが正常に使用できます。
  Clientでしか対戦が出来なかった方はお試しあれ。

  ★重要★    ポート開放はセキュリティリスクを生じます。ご理解の上、自己責任でご使用ください。
            使い終わったら極力閉めましょうね。

  ◆使用方法
    1.待受ポート番号を入力します。
    2.[開放]・[閉鎖]ボタンを押すと、待受ポート番号の開閉を試みます。
    3.開放に成功すると、ServerまたはHostモードで使用できます。
    4.閉鎖に成功すると、開放したポート番号のUPnP設定を削除します。

  ※主に以下のような場合で使用できない場合があります。
    ・UPnPが無効
    ・プライベートIPアドレス契約型の回線種類
    ・二重ルータ・ルータが存在しない環境
    ・ファイアウォール・セキュリティソフト設定でのUPnP制限
    ・未対応・強制的にUPnP無効のルータ機種
    ・バグ

  ◆設定したUPnP情報を確認する方法
    ルータの設定画面にアクセスするか、
    OS側のネットワーク探索が有効な場合、
    ネットワークのルータプロパティ・またはサービス等からUPnPの設定が確認できると思います。
    (例(Win7): ネットワーク->ルータのプロパティ->全般タブの設定->サービス)

  ※その他補足
    ルータ設定の静的ポート(NAT・NAPT)を開閉できるわけではありません。
    ルータ設定が可能であれば、この機能を使う必要はありません。

・メンバーリストコンテキストメニューに『名前をコピー』メニューを追加。
  メンバーリストからメンバーを左クリックで選択後、右クリックから名前をクリップボードにコピーできます。
・ログファイル保存形式をオプションから設定できるようになりました。
  それに伴い[/log]コマンドと[ログの保存](Ctrl+S)の動作を共通化しました。
  [オプション]->[設定]->[詳細]タブの[ログファイル保存形式]でRTF形式とTXT形式を選択できます。
・[オプション]->[設定]->[詳細]タブの[詳細設定]に[ログの削除でサーバ告知を残す]チェックボックスを追加しました。

■バグ修正
・匿名サーバモード、及び『ランダムに対戦を挑む』機能(/vs)で、Clientと対戦募集状態を対戦相手候補に含まない問題を修正。
  Clientでも、pingが通れば正常にランダム対戦が行えるようになりました。
・再起動時にサーバコメントの改行が正しく変換されない問題を修正。
・接続に失敗後、[再起動]コマンドから[閉じる]を押すと強制終了する問題を修正。
・同時に対戦要求を送ると強制終了する問題を対策。
  回線が不安定な状況で、接続失敗後ウィンドウが残る現象はまだ起きるかもしれません。
・ログの削除機能が正常に動作しなかった問題を修正。
  全削除後、設定でサーバ告知のみ残せるようにしました。

■その他
・スタートアップフォームのレイアウトを変更。
  [起動]ボタンを、
    Serverモード用の[起動]ボタンと、
    Host, Clientモード用の[接続]ボタンに分けました。
  設定ごとにマウスオーバーでツールチップ説明表示がつきました。
  コントロールボックスの閉じるボタンが再度付きました。
  [接続先ポート], [最大接続者数]の入力欄を削除しました。
    [接続先ポート]は直接アドレス欄に繋げて入力してください。
      (例: lilith.port.xx:7500)
    [最大接続者数]は[オプション]->[設定]->[基本]タブの[回線設定]で設定できます。
・最大接続者数のデフォルト値を100に変更。
  旧バージョンの設定ファイルを持ち越す場合は影響ありません。
  気になる方は[オプション]->[設定]->[基本]タブの[回線設定]から減らしてください。
・対戦募集状態でゲームを起動後、ゲーム終了時に対戦募集状態を締め切らないようにしました。
・匿名サーバモードの仕様を微修正。
・その他様々な文言の変更・微修正。
・CLRコンパイルモード変更。
  純粋MSIL(/clr:pure)から混合モード(/clr)に移行。
  なんだかファイルサイズが減ったぞ！

==================================
2015/10/24
LilithPort v1.07
重要な不具合修正による安定性向上と、ログ周りの新機能追加版

■新機能
・テキスト折り返し機能を追加しました。
  [オプション]->[ログのテキストを折り返す]から設定することが出来ます。
  ログのテキストがウィンドウ横幅を超えた際に自動で改行されます。

■バグ修正
・ログが流れる際に突然強制終了するバグを修正しました。
  全体的な安定性が向上しました。
・サーバホストには接続切れの警告メッセージを表示しないように修正しました。

■その他
・ログ全削除をログ削除に改変し、10行程残すように変更しました。

==================================
2015/08/19
LilithPort v1.06
要望のあった新機能追加と、既知の不具合修正版

■新機能
・対戦募集状態のままゲームを起動できるようになりました。
  CPU戦やトレーニングモードをしつつ、対戦募集をすることができます。
  対戦募集状態に切り替えた後、[コマンド]->[ゲームの起動]から状態を変更せずゲームを起動することができます。
  対戦募集状態でゲーム起動中に対戦申し込みがあった際は、自動でゲームを終了後、再度ゲームが起動し対戦が始まります。
・自動休憩機能を追加しました。
  フリー状態の時、一定時間マウス操作・キーボード操作を行わないと、自動で休憩状態になります。
  [オプション]->[自動で休憩状態にする]からON/OFFと時間を設定できます。
・[オプション]->[設定]->[ゲーム]タブの[タイトルバー]に対戦勝敗チェックボックスを追加しました。
  対戦数を表示しつつ、対戦中は勝敗表示をオフにすることが可能になりました。
  対戦成績はどちらでも表示されます。
■バグ修正
・LilithPortからゲームを起動すると、ゲーム終了後もゲームプロセスが残る不具合を修正しました。
・自分が対戦募集状態だと、メンバーリストコンテキストメニューから『対戦する』を選択できない不具合を修正しました。
  対戦募集状態でも対戦を申し込むことが可能になりました。
■その他
・サーバー準備完了時も時刻表示がされるようになりました。
・ゲーム起動時に表示される対戦設定の形式を変更しました。
・サーバ起動・接続時に設定が保存されるようになりました。
  強制終了してもスタートアップ設定が巻き戻らなくなりました。
・ディレイシミュレートが2P側にも反映されるようになりました。
  オフラインで、より熱帯に近い対戦が楽しめます。
・特定の状況下で、サーバーとの通信が途切れた可能性を警告するメッセージを追加しました。
  サーバーがクラッシュした直後、サーバーを再度起動した際に表示されることがあります。
・ゲームプロセスの一部例外をスルーするように変更しました。
  一部特定のOS環境で、ゲームを起動できない問題に対応しました。
  エラーコードERROR_NOACCESSをDBG_EXCEPTION_NOT_HANDLEDとして対応します。

==================================
2014/12/02
LilithPort v1.05beta1
サーバ監視ツールの動作検証、及び下位互換機能追加版

■新機能
・MTSPアドレス変換・接続機能を追加しました。
  MTSPの変換アドレスを生成、及び接続できるようになりました。
  [オプション]->[設定]->[IPの変換]タブから、MTSPアドレスを生成することが可能です。

  今更ながらの下位互換機能ですが、
  MTSPサーバ内でのLilithPort新機能の動作は保障できないので、注意してください。

・特殊サーバモードの追加（監視ツール用機能）
  『-s』コマンドライン引数オプションを追加しました。
  実行ファイルを起動する際に、『-s [ポート番号]』を引数として渡すことで、特殊サーバモードで実行します。

  特殊サーバモードで実行することにより、以下のオプションが付与されます。
    ・起動時のスタートアップダイアログが表示されず、保存されている設定値で即サーバが起動します。
    ・LilithPortが意図しない例外を検出した際、強制終了確認ダイアログが表示されず即プロセスを終了します。

==================================

2014/11/16
LilithPort v1.05
変換アドレスに関する重大な不具合修正と、機能追加に伴う設定ファイルの改変

■新機能
・プロファイル機能を追加しました。
  ゲーム設定に関係するオプションを、ステータスバーから瞬時に切り替えることが可能です。
  [オプション]->[設定]->[基本]タブから設定が可能です。
  [複製]ボタンで、現在選択しているプロファイルの複製を生成します。
  [削除]ボタンで、現在選択しているプロファイルを削除します。
  [追加]ボタンで、テキストボックスに入力されているプロファイル名でデフォルトオプションのプロファイルを新規に作成します。
  [保存]ボタンで、テキストボックスに入力されているプロファイル名で現在選択しているプロファイル名を上書き保存します。
  プロファイルは32個まで作成できます。
・メンバーリストコンテキストメニューに『対戦募集する』メニューを追加しました。
  メンバーリスト右クリックからも対戦募集が行えるようになりました。
・ブックマーク追加時、接続タイプと待受ポートも保存されるようになりました。
  接続する際に、ブックマーク追加時の接続タイプ（Host, Client）、待受ポートが自動で入力されます。
  v1.04以前のブックマークはデフォルト値Client, ポート7500で初期化されます。
■バグ修正
☆重要☆変換アドレスがUnicode変換になっていた問題の修正（v1.03, v1.04）
  v1.03, v1.04で生成される変換アドレスがUnicode変換のため、
  ASCII変換を行っている旧バージョンでは、変換アドレスで接続できない重大な不具合があります。

  v1.05ではASCII, Unicodeいずれも接続が可能ですが、
  v1.00, v1.01, v1.02はASCII版の変換アドレス、
  v1.03, v1.04はUnicode版の変換アドレスでしか接続ができないことに注意してください。

  ※IP接続, DNS接続は全てのバージョンで行えます。

  v1.05で生成される変換アドレスはASCII変換となっています。
  ちょっとした油断で、このような不具合が生まれてしまったことを深くお詫び申し上げます。
・KICK時にサーバー側でログが流れない問題の修正
・サーバ接続時のアドレス解決例外処理の改良
  サーバ接続時のアドレス解決にかかる時間が短縮されました。
■その他
・プロファイル機能実装につき、ini設定ファイルの構成を改変しました。
  共通オプションはSystemセクションにまとまっています。
  プロファイルで管理されるオプション項目は以下の通りです。
  GameExe          // ゲームの実行ファイルパス
  ReplayFolder     // リプレイ保存先フォルダーパス
  MaxStage         // 最大ステージ数
  StageSelect      // ランダムステージ
  Round            // ラウンド数
  Timer            // ゲームタイマー
  TeamRoundHP      // ラウンド間HP持ち越し
  SimulateDelay    // ローカルディレイシミュレート値
  HitJudge         // 当たり判定の表示
  DisplayName      // タイトルバーニックネーム表示
  DisplayVersus    // タイトルバー対戦数表示
  DisplayFramerate // タイトルバーフレームレート表示
  DisplayRand      // タイトルバー乱数使用回数表示
  ReplayDivide     // リプレイファイル圧縮
  ChangeWindowSize // 640x480で起動
  ChatHistory      // チャット入力履歴の保存数
  Delay            // ディレイ値
  Interval         // インターバル値
  ReplayVersion    // リプレイファイルバージョン
・ブックマーク接続をする際、スタートアップフォームのサーバ名を引き継がないようになりました。
  意図しないサーバ名でサーバを立ててしまわないよう考慮しました。
・スタートアップフォームのコントロールボックスを削除しました。
  ブックマーク接続時、[x]ボタンで接続してしまう問題の対策です。
・実行ファイルのアイコンとウィンドウのスモールアイコンが変わりました。
  なんだかファンシーになりました。
  要望やご意見を参考に、今後もバージョンによってコロコロ変わるかもしれません。

==================================
2014/11/06
LilithPort v1.04
安定性の向上と、既知のバグフィックス・機能追加

■新機能
・チームプレイ用ラウンド間HP持ち越し機能を追加しました。
  ラウンドで勝利したプレイヤーのHPが、次のラウンドも持ち越されます。やや実験的機能です。
  [オプション]->[設定]->[ゲーム]タブからON/OFF設定が可能です。
  ゲームの仕様によっては正常に動作しない可能性がありますので、ご注意ください。
  （ダメージを受けると発動する効果等）
  また、リプレイに設定値が保存されない為、持ち越しONで記録したリプレイを再生する際は、オプションから手動で設定してください。

・メンバーリスト更新機能を追加しました。
  [コマンド]->[メンバーリストの更新]またはF5でメンバーリストの更新が行えます。
  連続しての使用はサーバーに負荷がかかるため、注意してください。
  サーバーのリストを基準にしているので、サーバーが行う必要はありません。

・ゲームを起動する際に対戦設定を表示する機能を追加しました。
  [オプション]->[設定]->[詳細設定]タブからON/OFF設定が可能です。

・キック機能を追加しました。
  サーバーモードのみ、メンバー右クリックから使用できます。
  切断したい場合に使うおまけ機能です。
  
■バグ修正
・Unknown現象を対策しました。
  Unknownになった本人にサーバが通知します。
  サーバ、クライアント共に、メンバーリスト外のIDから発言があった際、
  リストバックアップから該当のIDを検索し、切断パケットを送信します。

・接続アドレス欄の文字数が正常に設定されていなかったのを修正しました。
  [変換IP:ポート]が、アドレス欄に入りきらないことがなくなりました。

・新たに見つかった不正な文字列リンクをクリックすると強制終了するバグを修正しました。
  いかなる不正な文字列リンクでも落ちることがなくなりました。

・異常動作のため保留していたメンバーリストのツールチップを、クリックで表示するように修正しました。

・RichTextBoxのSelectionStartの複数回指定を修正しました。
  チャット受信時に起きる強制終了が緩和する可能性があります。

■その他
・観戦の許可設定をデフォルトでONにしました。
  設定でOFFにすることは可能です。

・対戦する際、実行ファイルのチェックを混在鯖モード以外でも行うようになりました。
  混在鯖でなくても、対戦要求の際に相手とのゲームが違うと警告が出ます。

・キーワード反応のデリミタ説明文の誤りを訂正しました。
  (,)の説明部、コロンではなくコンマです。ゴメンナサイ。

・メンバーリストコンテキストメニューの「対戦する（リプレイを保存する）」項目を削除しました。

==================================
2014/10/15
LilithPort v1.03
大幅な機能追加・バグフィックス・UI/UXの向上

■新機能
・対戦募集中状態カラー（デフォルト青）の追加
  [コマンド]->[対戦募集状態の切り替え] か、チャット欄に[/seek]で対戦募集状態の設定が可能です。
  旧バージョンのLilithPort, MTSP側には見えないので注意してください。（対戦は行えます）

・対戦募集があった時に音声を再生する機能を追加
  [オプション]->[音声] から設定が可能です。

・発言で音声を再生する機能, 及びウィンドウを点滅する機能を追加しました。
  点滅は[オプション]->[設定]->[詳細]タブからON/OFF設定が可能です。

・各種音声再生のON/OFF設定機能を追加しました。
  [オプション]->[音声] の[有効]チェックボックスで設定が可能です。

・キーワードに反応して音声を再生する機能を追加
  [オプション]->[音声]->[キーワードで再生] から設定できます。
  デリミタはコロン(,)で複数設定ができます。（例： LilithPort,Lili Po,りりぽ）
  最大256byteまで登録できますが、数が多すぎると発言毎に処理落ちする可能性があります。

・チームプレイラウンドが[オプション]->[ゲーム]タブのラウンド数と同期するようになりました。
  オプションのラウンド数を設定することによって、チームプレイラウンドを（最大4まで）予め設定することができます。
  それに伴い、チームプレイに限り旧バージョンのLilithPort, MTSP間での対戦や、古いリプレイ再生がうまく行えないので注意してください。
  （要検証）

■バグ修正
・チャット欄のAutoWordSelectionプロパティが正常に適用されないRichTextBoxのバグを対策
  チャット欄のコピーがマウスでも1文字ずつ行えるようになりました。

・サーバメッセージが正常に文字数増加できていなかった問題の修正
  設定文字数増加に伴い、表示関数が最適化されていなかった問題を修正しました。
  サーバメッセージの表示文字数が増えました。（256byte > 512byte）

■その他
・オプションウィンドウを拡張しました。
  ・[詳細]タブを追加しました。各種機能のON/OFF設定が可能です。
    [発言でウィンドウを点滅する] オプションを追加しました。
    [オプション]->[呼ばれたらウィンドウを点滅する] をここに移動しました。

・ニックネームが呼ばれた時、発言があった時に再生する際の音声をデフォルトで同封
  デフォルトでONになりました。設定でON/OFFが可能です。

・サーバに接続する際に、サーバ側のLilithPort本体のバージョンを確認するようになりました。
  サーバとクライアントを比較してバージョン違いがわかります。

・パス指定テキストボックスのSelectionStartを末尾に設定しました。
  パス確認時の可読性が向上しました。

==================================
LilithPort v1.03beta2(動作検証版)

■その他
・.NET Frameworkの互換性問題により、ビルダを2008に戻しました。
  Visual Studio 2013でターゲットランタイムを.NET Framework 2.0/3.5に設定するのがうまくいかなかったためです。

・サーバメッセージの制限文字数が緩和しました。
  約2倍の文字数を設定できます。古いバージョンでは途切れてしまうかもしれません。

==================================
2014/09/20
LilithPort v1.03beta1（動作検証版）
ビルド環境の移行検証（VC++ 2008->VC++ 2013）・バグフィックス

※検証目的のβ版につき、同封ソースはありません。ご使用は自由です。
また、ビルダ移行により動作が不安定な可能性があるので、問題が起きた場合は正式バージョンを使用してみてください。

■バグ修正
・チャット欄のAutoWordSelectionプロパティが正常に適用されないRichTextBoxのバグを対策
  チャット欄のコピーがマウスでも1文字ずつ行えるようになりました。

==================================
2014/05/03
LilithPort v1.02
互換性のある機能追加・バグフィックス

■新機能
・IPアドレスを取得する機能を追加
  サーバ起動時、サーバ接続用の変換アドレスが自動で出力されるようになりました
  [コマンド]->[IPアドレスの取得] から手動で実行することもできます
  外部接続による取得のため、ややタイムアウト率が高いかもしれません

・コマンドメニューに『ゲームの起動（リプレイを保存しない）』項目の追加

■バグ修正
・接続アドレス欄に、不正なアドレスを入力することでエラー終了してしまう問題の修正

■その他
・サーバモードで起動時、サーバメッセージを表示するように変更

・スタートアップフォームのDNSチェックボックスを削除
  アドレスの種類を自動で識別するようになりました

・サーバ告知の改行をアンダーバー(_)ではなく改行コード(\n)に変更
  アンダーバーが含まれるURLが改行されてしまう問題への対応です
  入室時のサーバメッセージはどちらでも改行されなくなりました

==================================
2014/04/21
LilithPort v1.01
互換性のある機能追加・バグフィックス
v1.00にすべてのファイル上書きで設定を引き継げます。

■新機能
・ニックネーム反応機能の追加
  [オプション]->[設定]->[音声]タブ に『ニックネームが呼ばれたら再生』項目の追加
  それに合わせて、[オプション]メニューに『呼ばれたらウィンドウを点滅する』チェック項目の追加
  自分のニックネームがチャット発言されると、該当ログの時間表示がデバッグカラーになります。

・メンバーリストコンテキストメニューに『対戦する（リプレイを保存）』項目の追加
  リプレイ保存設定がオフでも、一時的にリプレイを保存して対戦が行えます。

・コマンドメニューに『当たり判定の表示切替』項目の追加
  LilithPort親ウィンドウをアクティブにした状態で、F1キーで瞬時に判定表示を切り替えられます。

・オプションメニューに『ログのスクロールを固定』チェック項目の追加
  F3キーで瞬時にログを固定化できます。

■バグ修正
・サーバメッセージの改行が正常に保存されなかった不具合の修正

・不正な文字列リンクをクリックすることで強制終了してしまう問題の修正

■その他
・[ブックマーク接続]、[再起動]、[退室]、[ログの全削除]コマンドに確認ダイアログを追加

・対戦開始メッセージにも時間を表示するように変更

・[オプション]->[ゲーム]タブ のニックネーム、対戦数、フレームレート項目をデフォルトでチェックに変更

・スタートアップウィンドウにコントロールボックスの追加
  xクリックでフリープレイに移行

・必要のないインクルードライブラリの削除
  ファイルサイズが小さくなりました

==================================
2014/04/16
LilithPort v1.00
りりぽ。

開発者変わりました。よろしくね。
『LilithPort』に名称変更。

★従来のIP変換機能と互換性が取れなくなりました。
  古い変換アドレスは、もう使用できません。
 
    使用できなくなった古いタイプ -> ほげhoげ
    新しいタイプ -> xxxxxxxxxxxxxxx=

  MTSPの鯖に接続する際は、新しい変換アドレスか、IPアドレス、DNSから接続してください。
  ただし、その際基本動作保証はできません。

また、MTSP.ini設定ファイルの持ち越しはできないので注意してください。

■新機能
・従来のIP変換機能の互換性がソース不完全のため取れなくなり、
  変わり(?)となるIP変換機能を追加。
  [オプション] -> [設定] -> [IPの変換]タブ　から使用できます。

・ブックマーク機能の追加
　　接続したサーバのアドレスを登録し、
  [ブックマーク] から接続できるようになりました。
  それに伴い、サーバ名にデリミタ文字(,)が使用できなくなりました。

  プロトタイプの為、動作が安定するかは不明。

・コマンドメニューの追加
  元からある基本コマンドをメニューからクリックで行えるようになりました。

・時間の表示
  発言や入退室に時間が表示されるようになりました。

・スタートアップのUI向上
  起動時の入力画面がひとつに統一され、わかりやすくなりました。
  [フリープレイ]ボタンを廃止、[閉じる]ボタンに変更。
  IP変換機能はオプション画面へお引っ越ししました。

■バグ修正

・一部テキストボックスのバリデーションチェックの修正
・メンバーリストのツールチップが異常動作していたため、一時無効化。
・他細かなバグ修正。